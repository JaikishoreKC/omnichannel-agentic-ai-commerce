============================= test session starts =============================
platform win32 -- Python 3.10.11, pytest-8.4.1, pluggy-1.6.0 -- C:\Users\kcjai\AppData\Local\Programs\Python\Python310\python.exe
cachedir: .pytest_cache
rootdir: D:\Projects\omnichannel-agentic-commerce\backend
configfile: pytest.ini
plugins: anyio-4.9.0, asyncio-1.3.0, cov-6.2.1
asyncio: mode=strict, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 1 item

tests/unit/test_repositories.py::test_cart_repository_roundtrip_in_memory FAILED

================================== FAILURES ===================================
__________________ test_cart_repository_roundtrip_in_memory ___________________

    def test_cart_repository_roundtrip_in_memory() -> None:
        store = InMemoryStore()
        mongo_manager, redis_manager = _fake_managers()
        repo = CartRepository(store=store, mongo_manager=mongo_manager, redis_manager=redis_manager)
    
        cart = {
            "id": "cart_test_1",
            "userId": None,
            "sessionId": "session_test_1",
            "items": [],
            "subtotal": 0.0,
            "tax": 0.0,
            "shipping": 0.0,
            "discount": 0.0,
            "total": 0.0,
            "itemCount": 0,
            "currency": "USD",
            "appliedDiscount": None,
            "createdAt": store.iso_now(),
            "updatedAt": store.iso_now(),
        }
    
        repo.create(cart)
        loaded = repo.get_for_user_or_session(user_id=None, session_id="session_test_1")
>       assert loaded is not None
E       assert None is not None

tests\unit\test_repositories.py:224: AssertionError
=========================== short test summary info ===========================
FAILED tests/unit/test_repositories.py::test_cart_repository_roundtrip_in_memory
============================== 1 failed in 0.36s ==============================
